/* sw-template.js
   This service worker will be generated by workbox injectManifest which will
   replace self.__WB_MANIFEST with the list of assets to precache.
*/
import { precacheAndRoute } from 'workbox-precaching';
import { registerRoute } from 'workbox-routing';
import { NetworkFirst, CacheFirst, StaleWhileRevalidate } from 'workbox-strategies';

precacheAndRoute(self.__WB_MANIFEST || []);

registerRoute(
  ({request}) => request.destination === 'document' || request.mode === 'navigate',
  new NetworkFirst({ cacheName: 'pranic-pages' })
);

registerRoute(
  ({request}) => request.destination === 'script' || request.destination === 'style',
  new StaleWhileRevalidate({ cacheName: 'pranic-assets' })
);

registerRoute(
  ({request}) => request.destination === 'image',
  new CacheFirst({ cacheName: 'pranic-images', plugins: [] })
);

// Fallback to index.html for navigation requests handled above by NetworkFirst
self.addEventListener('message', (event) => {
  if (event.data && event.data.type === 'SKIP_WAITING') self.skipWaiting();
});
